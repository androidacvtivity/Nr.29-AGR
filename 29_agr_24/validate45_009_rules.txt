
// Validation function for CAP1: row 1950 col.1 ≥ sum of rows 1951, 1952, and 1953 col.2
function validate45_009(values) {
    var col1 = "C1";
    var col2 = "C2";
    var col_1950 = !isNaN(Number(values["CAP1_R1950_" + col1])) ? Number(values["CAP1_R1950_" + col1]) : 0;
    var col_sum = 0;

    // Sum rows 1951, 1952, and 1953 for col.2
    for (var row = 1951; row <= 1953; row++) {
        col_sum += !isNaN(Number(values["CAP1_R" + row + "_" + col2])) ? Number(values["CAP1_R" + row + "_" + col2]) : 0;
    }

    if (col_1950 < col_sum) {
        webform.errors.push({
            'fieldName': 'CAP1_R1950_' + col1,
            'weight': 6,
            'msg': Drupal.t('Cod eroare: 45-009. Rând.1950 col.1 trebuie să fie ≥ suma rândurilor 1951+1952+1953 col.2. Valoarea rândului 1950 col.1: ' + col_1950 + ', suma calculată: ' + col_sum)
        });
    }
}

// Validation function for CAP1 FILIAL: row 1950 col.1 ≥ sum of rows 1951, 1952, and 1953 col.2
function validate45_009_F(values) {
    var col1 = "C1";
    var col2 = "C2";
    for (var j = 0; j < values.CAP_NUM_FILIAL.length; j++) {
        var CAP_CUATM_FILIAL = isNaN(String(values.CAP_CUATM_FILIAL[j])) ? "" : String(values.CAP_CUATM_FILIAL[j]);
        var col_1950_F = values["CAP1_R1950_" + col1 + "_FILIAL"] && !isNaN(Number(values["CAP1_R1950_" + col1 + "_FILIAL"][j]))
            ? Number(values["CAP1_R1950_" + col1 + "_FILIAL"][j])
            : 0;
        var col_sum_F = 0;

        // Sum rows 1951, 1952, and 1953 for col.2
        for (var row = 1951; row <= 1953; row++) {
            if (values["CAP1_R" + row + "_" + col2 + "_FILIAL"] && !isNaN(Number(values["CAP1_R" + row + "_" + col2 + "_FILIAL"][j]))) {
                col_sum_F += Number(values["CAP1_R" + row + "_" + col2 + "_FILIAL"][j]);
            }
        }

        if (col_1950_F < col_sum_F) {
            webform.errors.push({
                'fieldName': 'CAP1_R1950_' + col1 + '_FILIAL',
                'index': j,
                'weight': 6,
                'msg': Drupal.t('Raion: @CAP_CUATM_FILIAL - Cod eroare: 45-009-F. Rând.1950 col.1 trebuie să fie ≥ suma rândurilor 1951+1952+1953 col.2. Valoarea rândului 1950 col.1: ' + col_1950_F + ', suma calculată: ' + col_sum_F, {
                    '@CAP_CUATM_FILIAL': CAP_CUATM_FILIAL
                })
            });
        }
    }
}
